%% LyX 2.1.3 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[english]{article}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage{geometry}
\geometry{verbose,tmargin=3cm,bmargin=3cm,lmargin=3cm,rmargin=3cm}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{esint}

\makeatletter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Textclass specific LaTeX commands.
\theoremstyle{plain}
\newtheorem{thm}{\protect\theoremname}
  \theoremstyle{plain}
  \newtheorem{lem}[thm]{\protect\lemmaname}
  \theoremstyle{plain}
  \newtheorem{cor}[thm]{\protect\corollaryname}

\makeatother

\usepackage{babel}
  \providecommand{\corollaryname}{Corollary}
  \providecommand{\lemmaname}{Lemma}
\providecommand{\theoremname}{Theorem}

\begin{document}
In this paper, we consider the least squares loss. Thus we can specialize
the results in Lecue and Mitchell (LM) to the case where $f\mapsto R(f)$
is convex. Thus we will be establishing oracle inequalities on the
averaged version of the modified CV. We denote the averaged version
of the modified CV as $\bar{g}(\hat{\boldsymbol{\lambda}}|D^{(n)})$.

First we directly apply Lemma 3.1 from LM to our least squares problem.
\begin{lem}
(Lemma 3.1 from LM, a shifted basic inequality)

For any constant $a\ge0$, we have
\begin{eqnarray*}
 &  & \mathbb{P}_{D^{(n)}}\left(\|\bar{g}(\hat{\boldsymbol{\lambda}}|D^{(n)})(x)-g^{*}(x)\|_{L_{2}}^{2}\right)\\
 & \le & (1+a)\inf_{\lambda\in\Lambda}\left[\mathbb{P}_{D^{(n_{T})}}\left(\|\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})(x)-g^{*}(x)\|_{L_{2}}^{2}\right)\right]\\
 &  & +\mathbb{P}_{D^{(n)}}\left[\sup_{\lambda\in\Lambda}\left(\mathbb{P}-(1+a)P_{n_{V}}\right)\left(\left(y-\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})(x)\right)^{2}-\left(y-g^{*}(x)\right)^{2}\right)\right]
\end{eqnarray*}


where $P_{n_{V}}=\frac{1}{n_{v}}\sum_{Z_{i}\in D^{(n_{V})}}\delta_{Z_{i}}$
is the empirical average.\end{lem}
\begin{proof}
By Lemma 3.1
\begin{eqnarray*}
 &  & \mathbb{P}_{D^{(n)}}\left(\|y-\bar{g}(\hat{\boldsymbol{\lambda}}|D^{(n)})(x)\|_{L_{2}}^{2}-\|y-g^{*}(x)\|_{L_{2}}^{2}\right)\\
 & \le & (1+a)\inf_{\lambda\in\Lambda}\left[\mathbb{P}_{D^{(n_{T})}}\left(\|y-\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})(x)\|_{L_{2}}^{2}-\|y-g^{*}(x)\|_{L_{2}}^{2}\right)\right]\\
 &  & +\mathbb{P}_{D^{(n)}}\left[\sup_{\lambda\in\Lambda}\left(\mathbb{P}-(1+a)P_{n_{V}}\right)\left(\left(y-\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})(x)\right)^{2}-\left(y-g^{*}(x)\right)^{2}\right)\right].
\end{eqnarray*}


Note that for any $m\in\mathbb{N}$, 
\[
\mathbb{P}_{D^{(m)}}\left(\|y-\bar{g}(\hat{\boldsymbol{\lambda}}|D^{(m)})(x)\|_{L_{2}}^{2}-\|y-g^{*}(x)\|_{L_{2}}^{2}\right)=\mathbb{P}_{D^{(m)}}\left(\|\bar{g}(\hat{\boldsymbol{\lambda}}|D^{(m)})(x)-g^{*}(x)\|_{L_{2}}^{2}\right).
\]

\end{proof}
Next, we extend Lemma 3.4 from LM for our problem. We also add more
notation to clarify the dependencies.
\begin{lem}
(Lemma 3.4 from LM)

Let $\mathcal{Q}(D^{(m)})\equiv\left\{ Q(\lambda|D^{(m)}):\lambda\in\Lambda\right\} $
and $\mathcal{Q}\equiv\cup_{m\in\mathbb{N}}\cup_{D^{(m)}}\mathcal{Q}(D^{(m)})$.

Suppose there exists $C_{1}>0$ and increasing function $G(\cdot)$
such that $\forall Q\in\mathcal{Q}$, 
\[
\|Q(Z)\|_{L_{2}}\le G\left(\mathbb{P}Q(Z)\right).
\]


Let $n_{T},n_{V}\in\mathbb{N}$ and fix a dataset $D^{(n_{T})}$.
Suppose there exist functions $D^{(n_{T})}\mapsto h(D^{(n_{T})})\in\mathbb{R}^{+}$
and $\left\{ \epsilon\mapsto J_{\delta}(\epsilon):\delta>0\right\} $
and a constant $\epsilon_{\min}>0$ such that for any dataset $D^{(n_{T})}$,
\[
h(D^{(n_{T})})\le\delta\implies\frac{\log n_{V}}{\sqrt{n_{V}}}\gamma_{1}\left(\mathcal{Q}_{\epsilon}^{L_{2}}(D^{(n_{T})}),\|\cdot\|_{L_{\psi_{1}}}\right)+\gamma_{2}\left(\mathcal{Q}_{\epsilon}^{L_{2}}(D^{(n_{T})}),\|\cdot\|_{L_{2}}\right)\le J_{\delta}(\epsilon)\forall\epsilon\ge\epsilon_{\min}
\]
where $\mathcal{Q}_{\epsilon}^{L_{2}}(D^{(n_{T})})\equiv\left\{ Q\in\mathcal{Q}(D^{(n_{T})}):\|Q(Z)\|_{L_{2}}\le G(\epsilon)\right\} $.

Then there exists some absolute constant $L,c>0$ such that for all
$\epsilon\ge\epsilon_{\min}$ and for all $u\ge1$,
\[
\Pr\left(\sup_{Q\in\mathcal{Q}(D^{(n_{T})})}\left(\left(\mathbb{P}-P_{n_{V}}\right)Q\right)_{+}\le uL\frac{J_{\delta}(\epsilon)}{\sqrt{n_{V}}}\mid h\left(D^{(n_{T})}\right)\le\delta\right)\ge1-L\exp(-cu).
\]
\end{lem}
\begin{proof}
Nothing needs to change in their proof. The proof never actually uses
the assumption they made originally.
\end{proof}
Next, we restate Lemma 3.2 in a similar fashion to clarify the dependencies.
\begin{lem}
(Lemma 3.2 from LM)

Let $a>0$. Let $\mathcal{Q}(D^{(m)})\equiv\left\{ Q(\lambda|D^{(m)}):\lambda\in\Lambda\right\} $
be a set of measurable functions.

Let random variable $Z$ satisfy for all $m\in\mathbb{N}$, any dataset
$D^{(m)}$, $\mathbb{P}Q(Z)\ge0\forall Q\in\mathcal{Q}\left(D^{(m)}\right)$.

Suppose for any $n_{T},n_{V}\in\mathbb{N}$ and dataset $D^{(n_{T})}$
there exists some absolute constant $L,c>0$ such that for all $\epsilon\ge\epsilon_{\min}$
and for all $u\ge1$,

\[
\Pr\left(\sup_{Q\in\mathcal{Q}(D^{(n_{T})})}\left(\left(\mathbb{P}-P_{n_{V}}\right)Q\right)_{+}\le uL\frac{J_{\delta}(\epsilon)}{\sqrt{n_{V}}}\mid h\left(D^{(n_{T})}\right)\le\delta\right)\ge1-L\exp(-cu).
\]


Suppose every function in $\left\{ J_{\delta}:\delta>0\right\} $
is strictly increasing and its inverse is strictly convex.

Let $\psi_{\delta}$ be the convex conjugate of $J_{\delta}^{-1}$,
e.g. $\psi_{\delta}(u)=\sup_{v>0}uv-J_{\delta}^{-1}(v)\forall u>0$.
Assume there is a $r\ge1$ such that $x>0\mapsto\psi(x)/x^{r}$ decreases
and define for $q>1$ and $u\ge1$,
\[
\epsilon_{q,\delta}(u)=\psi_{\delta}\left(\frac{2q^{r+1}(1+a)u}{a\sqrt{n_{V}}}\right)\vee\epsilon_{\min}.
\]


Then there exists a constant $L_{1}$ that only depends on $L$ such
that for every $u\ge1$,
\[
\Pr\left(\sup_{Q\in\mathcal{Q}(D^{(n_{T})})}\left(\left(\mathbb{P}-(1+a)P_{n_{V}}\right)Q\right)_{+}\le\frac{a\epsilon_{q,\delta}(u/q)}{q}\mid h\left(D^{(n_{T})}\right)\le\delta\right)\ge1-L_{1}\exp(-cu).
\]


Moreover, assume that $\psi_{\delta}$ increases such that $\psi_{\delta}(\infty)=\infty$.
Then there exists a constant $c_{1}$that depends only on $L$ and
$c$ such that
\[
\mathbb{P}\left[\sup_{Q\in\mathcal{Q}(D^{(n_{T})})}\left(\left(\mathbb{P}-(1+a)P_{n_{V}}\right)Q\right)_{+}\mid h\left(D^{(n_{T})}\right)\le\delta\right]\le\frac{ac_{1}\epsilon_{q,\delta}(1/q)}{q}.
\]

\end{lem}
Finally, we are ready to state our extension to LM's results. It is
the result of a simple chaining argument.
\begin{lem}
Let $a>0$.

There exist a constant $c_{1}$such that for any $n_{T},n_{V},\delta$
and $q>1$, we have 
\[
\mathbb{P}\left[\sup_{Q\in\mathcal{Q}(D^{(n_{T})})}\left(\left(\mathbb{P}-(1+a)P_{n_{V}}\right)Q\right)_{+}\mid h\left(D^{(n_{T})}\right)\le\delta\right]\le\frac{ac_{1}\epsilon_{q,\delta}(1/q)}{q}.
\]


Then for any $\sigma$,
\[
\mathbb{P}\left[\sup_{Q\in\mathcal{Q}(D^{(n_{T})})}\left(\left(\mathbb{P}-(1+a)P_{n_{V}}\right)Q\right)_{+}\right]\le\frac{ac\epsilon_{q,2\sigma}(1/q)}{q}+\sum_{k=1}^{\infty}\Pr\left(h\left(D^{(n_{T})}\right)\ge2^{k}\sigma\right)\frac{ac\epsilon_{q,2^{k}\sigma}(1/q)}{q}.
\]
\end{lem}
\begin{proof}
By a simple chaining argument, we have
\begin{eqnarray*}
 &  & \mathbb{P}\left[\sup_{Q\in\mathcal{Q}(D^{(n_{T})})}\left(\left(\mathbb{P}-(1+a)P_{n_{V}}\right)Q\right)_{+}\right]\\
 & \le & \Pr\left(h\left(D^{(n_{T})}\right)\le2\sigma\right)\mathbb{P}\left[\sup_{Q\in\mathcal{Q}(D^{(n_{T})})}\left(\left(\mathbb{P}-(1+a)P_{n_{V}}\right)Q\right)_{+}\mid h\left(D^{(n_{T})}\right)\le2\sigma\right]\\
 &  & +\sum_{k=1}^{\infty}\Pr\left(2^{k}\sigma\le h\left(D^{(n_{T})}\right)\le2^{k+1}\sigma\right)\mathbb{P}\left[\sup_{Q\in\mathcal{Q}(D^{(n_{T})})}\left(\left(\mathbb{P}-(1+a)P_{n_{V}}\right)Q\right)_{+}\mid h\left(D^{(n_{T})}\right)\le2^{k+1}\sigma\right]\\
 & \le & \frac{ac\epsilon_{q,2\sigma}(1/q)}{q}+\sum_{k=1}^{\infty}\Pr\left(h\left(D^{(n_{T})}\right)\ge2^{k}\sigma\right)\frac{ac\epsilon_{q,2^{k}\sigma}(1/q)}{q}.
\end{eqnarray*}

\end{proof}
Let us combine the results from above to get the following theorem.
\begin{thm}
Suppose all the stuff before.

Consider any $\sigma>0$.

Then there exist constant $c_{1}>0$ such that

\begin{eqnarray*}
 &  & \mathbb{P}_{D^{(n)}}\left(\|\bar{g}(\hat{\boldsymbol{\lambda}}|D^{(n)})(x)-g^{*}(x)\|_{L_{2}}^{2}\right)\\
 & \le & (1+a)\inf_{\lambda\in\Lambda}\left[\mathbb{P}_{D^{(n_{T})}}\left(\|\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})(x)-g^{*}(x)\|_{L_{2}}^{2}\right)\right]\\
 &  & +\frac{ac\epsilon_{q,2\sigma}(1/q)}{q}+\sum_{k=1}^{\infty}\Pr\left(h\left(D^{(n_{T})}\right)\ge2^{k}\sigma\right)\frac{ac\epsilon_{q,2^{k}\sigma}(1/q)}{q}
\end{eqnarray*}

\end{thm}
To see why the theorem above is useful, we will now walk through the
case where the fitted functions are Lipschitz in the hyper-parameters.
We will see that the chaining argument shows that all we need to do
is to control the following sum 
\[
\sum_{k=1}^{\infty}k\Pr\left(h\left(D^{(n_{T})}\right)\ge2^{k}\right).
\]


Note that 
\[
\mathcal{Q}(D^{(n_{T})})=\left\{ \left(y-\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})(x)\right)^{2}-\left(y-g^{*}(x)\right)^{2}:\boldsymbol{\lambda}\in\Lambda\right\} 
\]

\begin{lem}
Covering number bounds with Lipschitz functions

Suppose there exists a function $G(x|D^{(n_{T})})$ and constants
$c,r>0$ such that for any $m\in\mathbb{N}$ and any dataset $D^{(m)}$,
we have 
\begin{align}
\left|\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(1)}|D^{(n_{T})})(x)-\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(1)}|D^{(n_{T})})(x)\right|\le G(x|D^{(n_{T})})\|\boldsymbol{\lambda}^{(1)}-\boldsymbol{\lambda}^{(2)}\|_{2}.
\end{align}


and 
\[
\|g^{*}-\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})\|_{L_{\psi_{2}}}\le c\left(\|g^{*}-\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})\|_{L_{2}}\right)^{r}.
\]


For $\mathcal{Q}_{\epsilon}^{L_{2}}(D^{(n_{T})})\equiv\left\{ Q\in\mathcal{Q}(D^{(n_{T})}):\|g^{*}-\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})\|_{L_{2}}\le\sqrt{\epsilon},\boldsymbol{\lambda}\in\Lambda\right\} $,
we have 
\begin{align}
N\left(\mathcal{Q}_{\epsilon}^{L_{2}}(D^{(n_{T})}),u,\|\cdot\|_{L_{2}}\right)\le N\left(\Lambda,\frac{u}{2\left(\|\epsilon\|_{L_{2}}+\sqrt{\epsilon}\right)\|G(x|D^{(n_{T})})\|_{L_{2}}},\|\cdot\|_{2}\right)
\end{align}
and
\begin{align}
N\left(\mathcal{Q}_{\epsilon}^{L_{2}}(D^{(n_{T})}),u,\|\cdot\|_{L_{\psi_{1}}}\right)\le N\left(\Lambda,\frac{u}{2\left(\|\epsilon\|_{L_{\psi_{2}}}+c\epsilon^{r/2}\right)\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}},\|\cdot\|_{2}\right).
\end{align}
\end{lem}
\begin{proof}
First let us consider a general norm $\|\cdot\|$ such that $\|XY\|\le\|X\|_{*}\|Y\|_{*}$.
(For the norm $\|\cdot\|_{L_{\psi_{1}}}$, $\|\cdot\|_{*}=\|\cdot\|_{L_{\psi_{2}}}$.)
We bound the distance between functions $q\in\mathcal{Q}_{\epsilon}^{L_{2}}$
with respect to the norm $\|\cdot\|$ as follows:

\begin{align}
 & \left\Vert \left(y-\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(1)}|D^{(n_{T})})(x)\right)^{2}-\left(y-g^{*}(x)\right)^{2}-\left(y-\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(2)}|D^{(n_{T})})(x)\right)^{2}-\left(y-g^{*}(x)\right)^{2}\right\Vert \\
 & =\left\Vert \left(y-\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(2)}|D^{(n_{T})})(x)\right)\left(\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(2)}|D^{(n_{T})})(x)-\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(1)}|D^{(n_{T})})(x)\right)-\left(\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(2)}|D^{(n_{T})})(x)-\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(1)}|D^{(n_{T})})(x)\right)^{2}\right\Vert \\
%
 & \le\left\Vert 2\epsilon+g^{*}-\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(1)}|D^{(m)})(x)+g^{*}-\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(2)}|D^{(m)})(x)\right\Vert _{*}\left\Vert \hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(2)}|D^{(n_{T})})(x)-\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(1)}|D^{(n_{T})})(x)\right\Vert _{*}\\
 & \le\left(\|2\epsilon\|_{*}+\left\Vert g^{*}-\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(1)}|D^{(m)})(x)\right\Vert _{*}+\left\Vert g^{*}-\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(2)}|D^{(m)})(x)\right\Vert _{*}\right)\left\Vert \hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(2)}|D^{(n_{T})})(x)-\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(1)}|D^{(n_{T})})(x)\right\Vert _{*}\\
 & \le2\left(\|\epsilon\|_{*}+\sup_{\lambda\in\Lambda:\|g^{*}-\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})\|_{L_{2}}\le\sqrt{\epsilon}}\left\Vert g^{*}-\hat{g}^{(n_{T})}(\boldsymbol{\lambda}|D^{(m)})(x)\right\Vert _{*}\right)\left\Vert \hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(2)}|D^{(n_{T})})(x)-\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(1)}|D^{(n_{T})})(x)\right\Vert _{*}\\
 & \le2\left(\|\epsilon\|_{*}+\sup_{\lambda\in\Lambda:\|g^{*}-\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})\|_{L_{2}}\le\sqrt{\epsilon}}\left\Vert g^{*}-\hat{g}^{(n_{T})}(\boldsymbol{\lambda}|D^{(m)})(x)\right\Vert _{*}\right)\|G(x)\|_{*}\|\boldsymbol{\lambda}^{(1)}-\boldsymbol{\lambda}^{(2)}\|_{2}.
\end{align}


For $\|\cdot\|_{L_{2}}$, the upper bound reduces to $2\left(\|\epsilon\|_{L_{2}}+\sqrt{\epsilon}\right)\|G(x)\|_{L_{2}}\|\boldsymbol{\lambda}^{(1)}-\boldsymbol{\lambda}^{(2)}\|_{2}.$

For $\|\cdot\|_{L_{\psi_{1}}}$, the upper bound reduces to $2\left(\|\epsilon\|_{L_{\psi_{2}}}+c\epsilon^{r/2}\right)\|G(x)\|_{L_{\psi_{2}}}\|\boldsymbol{\lambda}^{(1)}-\boldsymbol{\lambda}^{(2)}\|_{2}.$
\end{proof}
For this to be useful for bounding the $\gamma$-function from Talagrand,
we need to check that a Cauchy-Schwarz-like inequality also holds
for the $\psi_{1}$-norm.
\begin{lem}
Orlicz norm Cauchy-Schwarz-like

For any random variables $X,Y$, we have

\[
\|XY\|_{L_{\psi_{1}}}\le\|X\|_{L_{\psi_{2}}}\|Y\|_{L_{\psi_{2}}}
\]
\end{lem}
\begin{proof}
By the definition of the Orlicz norm, it suffices to show that 
\[
\mathbb{P}\left[\psi_{1}\left(\frac{|XY|}{\|X\|_{L_{\psi_{2}}}\|Y\|_{L_{\psi_{2}}}}\right)\right]\le1.
\]


By Taylor expansion:
\begin{eqnarray*}
\mathbb{P}\left[\exp\left(\frac{|XY|}{\|X\|_{L_{\psi_{2}}}\|Y\|_{L_{\psi_{2}}}}\right)-1\right] & = & \mathbb{P}\left[\sum_{k=1}^{\infty}\left(\frac{|XY|}{\|X\|_{L_{\psi_{2}}}\|Y\|_{L_{\psi_{2}}}}\right)^{k}\frac{1}{k!}\right]\\
 & = & \mathbb{P}\left[\sum_{k=1}^{\infty}\left(\frac{|X|}{\|X\|_{L_{\psi_{2}}}}\right)^{k}\sqrt{\frac{1}{k!}}\left(\frac{|Y|}{\|Y\|_{L_{\psi_{2}}}}\right)^{k}\sqrt{\frac{1}{k!}}\right]\\
 & \le & \mathbb{P}\left[\sqrt{\sum_{k=1}^{\infty}\left(\left[\frac{|X|}{\|X\|_{L_{\psi_{2}}}}\right]^{2}\right)^{k}\frac{1}{k!}}\sqrt{\sum_{k=1}^{\infty}\left(\left[\frac{|Y|}{\|Y\|_{L_{\psi_{2}}}}\right]^{2}\right)^{k}\frac{1}{k!}}\right]\\
 & = & \mathbb{P}\left[\sqrt{\exp\left(\left[\frac{|X|}{\|X\|_{L_{\psi_{2}}}}\right]^{2}\right)-1}\sqrt{\exp\left(\left[\frac{|Y|}{\|Y\|_{L_{\psi_{2}}}}\right]^{2}\right)-1}\right]\\
 & = & \mathbb{P}\left[\sqrt{\psi_{2}\left(\frac{|X|}{\|X\|_{L_{\psi_{2}}}}\right)}\sqrt{\psi_{2}\left(\frac{|Y|}{\|Y\|_{L_{\psi_{2}}}}\right)}\right]\\
 & \le & \sqrt{\mathbb{P}\left[\psi_{2}\left(\frac{|X|}{\|X\|_{L_{\psi_{2}}}}\right)\right]\mathbb{P}\left[\psi_{2}\left(\frac{|Y|}{\|Y\|_{L_{\psi_{2}}}}\right)\right]}\\
 & = & 1
\end{eqnarray*}


where the first inequality followed by Holder's for infinite sequences
and the last inequality follows by Holders/Cauchy-Schwarz again.
\end{proof}
Now let us prove a bound on the covering number of the box $\Lambda$
\begin{lem}
Let $\Lambda=[\lambda_{\min},\lambda_{\max}]^{J}$ where $\lambda_{\min}\le\lambda_{\max}$.
Then 
\begin{align}
N\left(u,\Lambda,\|\cdot\|_{2}\right)\le\left(\frac{4\left(\lambda_{max}-\lambda_{min}\right)+2u}{u}\right)^{J}.
\end{align}
\end{lem}
\begin{proof}
Use a slight variation of the proof for Lemma 2.5 in Van de geer (2000). 
\end{proof}
Now we are ready to use the bounds on covering numbers and the Cauchy-Schwarz-like
inequality to bound the $\gamma$-function from Talagrand. Recall
from LM and Talagrand that (for an absolute constant $c$?) 
\[
\gamma_{\alpha}(T,D)\le c\int_{0}^{\text{Diam}(T,d)}\left(\log N(T,\epsilon,d)\right)^{1/\alpha}d\epsilon.
\]

\begin{lem}
$\gamma$-function from Talagrand for Lipschitz functions

Suppose there exists a function $G(x|D^{(n_{T})})$ and some $K_{2}\ge1$
and $r>0$ such that for any $m\in\mathbb{N}$ and any dataset $D^{(m)}$,
we have 
\begin{align}
\left|\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(1)}|D^{(n_{T})})(x)-\hat{g}^{(n_{T})}(\boldsymbol{\lambda}^{(1)}|D^{(n_{T})})(x)\right|\le G(x|D^{(n_{T})})\|\boldsymbol{\lambda}^{(1)}-\boldsymbol{\lambda}^{(2)}\|_{2}.
\end{align}


and 
\[
\|g^{*}-\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})\|_{L_{\psi_{2}}}\le K_{2}\left(\|g^{*}-\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})\|_{L_{2}}\right)^{r}.
\]


For $\Lambda$, let $\Delta_{\Lambda}=\lambda_{max}-\lambda_{min}$. 

Let $\epsilon>0$. Let $\mathcal{Q}_{\epsilon}^{L_{2}}(D^{(n_{T})})\equiv\left\{ Q\in\mathcal{Q}(D^{(n_{T})}):\|g^{*}-\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})\|_{L_{2}}\le\sqrt{\epsilon},\boldsymbol{\lambda}\in\Lambda\right\} $.
Then there is an absolute constant $c>0$ such that
\begin{eqnarray*}
\gamma_{2}\left(\mathcal{Q}_{\epsilon}^{L_{2}}(D^{(n_{T})}),\|\cdot\|_{L_{2}}\right) & \le & 2c\sqrt{\epsilon J}\left[\sqrt{\log\left(\frac{4\Delta_{\Lambda}\|\epsilon\|_{L_{2}}\|G(x|D^{(n_{T})})\|_{L_{2}}}{\sqrt{\epsilon}}+4\Delta_{\Lambda}\|G(x|D^{(n_{T})})\|_{L_{2}}+2\right)}+\frac{\sqrt{\pi}}{2}\right].
\end{eqnarray*}


If for any $D^{(n_{T})}$, we have that $\forall Q\in\mathcal{Q}(D^{(n_{T})}),\|Q\|_{L_{\psi_{1}}}\le K$,
then there is a constant $\tilde{c}$ dependent of $K_{2},K,\|\epsilon\|_{\psi_{2}}$
such that

\begin{eqnarray*}
\gamma_{1}\left(\mathcal{Q}_{\epsilon}^{L_{2}}(D^{(n_{T})}),\|\cdot\|_{L_{\psi_{1}}}\right) & \le & c_{1}JK\left[\log\left(\Delta_{\Lambda}\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}\tilde{c}+1\right)+\frac{r}{2}\log\left(\epsilon+1\right)+1\right].
\end{eqnarray*}
\end{lem}
\begin{proof}
We first bound $\gamma_{2}$ function. The diameter is by assumption
\begin{eqnarray*}
\text{Diam}\left(\mathcal{Q}_{\epsilon}^{L_{2}}(D^{(n_{T})}),\|\cdot\|_{L_{2}}\right) & = & 2\sqrt{\epsilon}.
\end{eqnarray*}


We plug in the results from the covering number lemmas above.

\begin{eqnarray*}
\gamma_{2}\left(\mathcal{Q}_{\epsilon}^{L_{2}}(D^{(n_{T})}),\|\cdot\|_{L_{2}}\right) & \le & c\int_{0}^{2\sqrt{\epsilon}}\sqrt{\log N\left(\mathcal{Q}_{\epsilon}^{L_{2}}(D^{(n_{T})}),u,\|\cdot\|_{L_{2}}\right)}du\\
 & \le & c\int_{0}^{2\sqrt{\epsilon}}\sqrt{\log N\left(\Lambda,\frac{u}{2\left(\|\epsilon\|_{L_{2}}+\sqrt{\epsilon}\right)\|G(x|D^{(n_{T})})\|_{L_{2}}},\|\cdot\|_{2}\right)}du\\
 & \le & c\int_{0}^{2\sqrt{\epsilon}}\sqrt{J\log\left(\frac{8\Delta_{\Lambda}\left(\|\epsilon\|_{L_{2}}+\sqrt{\epsilon}\right)\|G(x|D^{(n_{T})})\|_{L_{2}}+2u}{u}\right)}du\\
 & \le & c\sqrt{J}\int_{0}^{2\sqrt{\epsilon}}\sqrt{\log\left(\frac{8\Delta_{\Lambda}\left(\|\epsilon\|_{L_{2}}+\sqrt{\epsilon}\right)\|G(x|D^{(n_{T})})\|_{L_{2}}+4\sqrt{\epsilon}}{u}\right)}du\\
 & = & 2c\sqrt{\epsilon J}\int_{0}^{1}\sqrt{\log\left(\frac{8\Delta_{\Lambda}\left(\|\epsilon\|_{L_{2}}+\sqrt{\epsilon}\right)\|G(x|D^{(n_{T})})\|_{L_{2}}+4\sqrt{\epsilon}}{2\sqrt{\epsilon}v}\right)}dv\\
 & \le & 2c\sqrt{\epsilon J}\int_{0}^{1}\sqrt{\log\left(\frac{8\Delta_{\Lambda}\left(\|\epsilon\|_{L_{2}}+\sqrt{\epsilon}\right)\|G(x|D^{(n_{T})})\|_{L_{2}}+4\sqrt{\epsilon}}{2\sqrt{\epsilon}}\right)}+\sqrt{\log\frac{1}{v}}dv\\
 & = & 2c\sqrt{\epsilon J}\left[\sqrt{\log\left(\frac{8\Delta_{\Lambda}\left(\|\epsilon\|_{L_{2}}+\sqrt{\epsilon}\right)\|G(x|D^{(n_{T})})\|_{L_{2}}+4\sqrt{\epsilon}}{2\sqrt{\epsilon}}\right)}+\frac{\sqrt{\pi}}{2}\right]
\end{eqnarray*}


Now let's bound the $\gamma_{1}$-function. 
\begin{eqnarray*}
\gamma_{1}\left(\mathcal{Q}_{\epsilon}^{L_{2}}(D^{(n_{T})}),\|\cdot\|_{L_{\psi_{1}}}\right) & \le & c\int_{0}^{K}\log N\left(\mathcal{Q}_{\epsilon}^{L_{2}}(D^{(n_{T})}),u,\|\cdot\|_{L_{\psi_{1}}}\right)du\\
 & \le & c\int_{0}^{K}\log N\left(\Lambda,\frac{u}{2\left(\|\epsilon\|_{L_{\psi_{2}}}+K_{2}\epsilon^{r/2}\right)\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}},\|\cdot\|_{2}\right)du\\
 & \le & c\int_{0}^{K}J\log\left(\frac{8\Delta_{\Lambda}\left(\|\epsilon\|_{L_{\psi_{2}}}+K_{2}\epsilon^{r/2}\right)\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}+2u}{u}\right)du\\
 & \le & cJ\int_{0}^{K}\log\left(\frac{8\Delta_{\Lambda}\left(\|\epsilon\|_{L_{\psi_{2}}}+K_{2}\epsilon^{r/2}\right)\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}+2K}{u}\right)du\\
 & = & cJK\int_{0}^{1}\log\left(\frac{8\Delta_{\Lambda}\left(\|\epsilon\|_{L_{\psi_{2}}}+K_{2}\epsilon^{r/2}\right)\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}+2K}{Kv}\right)dv\\
 & = & cJK\int_{0}^{1}\log\left(\frac{8\Delta_{\Lambda}\left(\|\epsilon\|_{L_{\psi_{2}}}+K_{2}\epsilon^{r/2}\right)\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}+2K}{K}\right)+\log\frac{1}{v}dv\\
 & = & cJK\left[\log\left(\frac{8\Delta_{\Lambda}\left(\|\epsilon\|_{L_{\psi_{2}}}+K_{2}\epsilon^{r/2}\right)\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}+2K}{K}\right)+1\right]
\end{eqnarray*}
by the same set of arguments as above. We can reduce $\gamma_{1}$
to be a bit easier to handle. If $c\ge1$, then
\begin{eqnarray*}
\gamma_{1}\left(\mathcal{Q}_{\epsilon}^{L_{2}}(D^{(n_{T})}),\|\cdot\|_{L_{\psi_{1}}}\right) & \le & c_{1}JK\left[\log\left(\frac{K_{2}\Delta_{\Lambda}\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}\left(\|\epsilon\|_{L_{\psi_{2}}}+1\right)+K}{K}\left(\epsilon+1\right)^{r/2}\right)+1\right]\\
 & = & c_{1}JK\left[\log\left(\frac{K_{2}\Delta_{\Lambda}\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}\left(\|\epsilon\|_{L_{\psi_{2}}}+1\right)+K}{K}\right)+\frac{r}{2}\log\left(\epsilon+1\right)+1\right]
\end{eqnarray*}


Now we combine these bounds on the $\gamma$-functions and Lemma 2
(also Lemma 3.4 in LM) to get the following corollary.\end{proof}
\begin{cor}
We have the following bound. For all $\epsilon>1/n_{V}$ and $\delta\ge\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}$
and $\Delta_{\Lambda}\ge1$ , we have

\[
\mathcal{J}_{\delta}(\epsilon)=\frac{\log n_{V}}{\sqrt{n_{V}}}c_{1}JK\left[\log\left(\Delta_{\Lambda}\delta\tilde{c}+1\right)+1\right]+c_{2}\frac{\log n_{V}}{\sqrt{n_{V}}}JKr\log\left(\epsilon+1\right)+c_{3}\sqrt{\epsilon J}\left[\sqrt{\log\left(\Delta_{\Lambda}\|\epsilon\|_{L_{2}}\delta n_{v}+1\right)}+1\right]
\]
as a bound for the quantity above.\end{cor}
\begin{thm}
Suppose all the stuff before.

Define $\Delta_{\Lambda}=\left(\lambda_{\max}-\lambda_{\min}\right)\vee1.$

Suppose there exists a function $\tilde{h}$ such that 
\[
\tilde{h}(n_{T})\ge\sum_{k=1}^{\infty}k\Pr\left(\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}\ge2^{k}\sigma_{0}\right)
\]


(The bound $\tilde{h}(n_{T})\ge\int\left(\log_{2}\left(c\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}/\sigma\right)\right)^{2}d\mu\left(D^{(n_{T})}\right)$
also works.)

Then there exist constant $c_{1}>0$ and a constant $\tilde{c}>0$
that depends on $K_{2},K,r,\|\epsilon\|_{\psi_{2}}$ such that

\begin{eqnarray*}
 &  & \mathbb{P}_{D^{(n)}}\left(\|\bar{g}(\hat{\boldsymbol{\lambda}}|D^{(n)})(x)-g^{*}(x)\|_{L_{2}}^{2}\right)\\
 & \le & (1+a)\inf_{\lambda\in\Lambda}\left[\mathbb{P}_{D^{(n_{T})}}\left(\|\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})(x)-g^{*}(x)\|_{L_{2}}^{2}\right)\right]\\
 &  & +c_{1}\frac{\left(1+a\right)^{2}}{a}\frac{J\log n_{V}}{n_{V}}\tilde{c}\log\left(\tilde{c}\frac{\left(1+a\right)}{a}\Delta_{\Lambda}J\sigma_{0}+1\right)\left(1+\tilde{h}(n_{T})\right).
\end{eqnarray*}
\end{thm}
\begin{proof}
By Lemma 1, 
\begin{eqnarray*}
 &  & \mathbb{P}_{D^{(n)}}\left(\|\bar{g}(\hat{\boldsymbol{\lambda}}|D^{(n)})(x)-g^{*}(x)\|_{L_{2}}^{2}\right)\\
 & \le & (1+a)\inf_{\lambda\in\Lambda}\left[\mathbb{P}_{D^{(n_{T})}}\left(\|\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})(x)-g^{*}(x)\|_{L_{2}}^{2}\right)\right]\\
 &  & +\mathbb{P}_{D^{(n)}}\left[\sup_{\lambda\in\Lambda}\left(\mathbb{P}-(1+a)P_{n_{V}}\right)\left(\left(y-\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})(x)\right)^{2}-\left(y-g^{*}(x)\right)^{2}\right)\right].
\end{eqnarray*}


We need to bound the second term on the RHS. We would like to use
Lemma 4.

From Corollary 9, we know that $\mathcal{J}_{\delta}(\epsilon)$ has
the form $\mathcal{J}_{\delta}(\epsilon)=A_{0,\delta}+A_{1}\log(\epsilon+1)+A_{2,\delta}\sqrt{\epsilon}$.

$\mathcal{J}_{\delta}$ is strictly increasing and as $\mathcal{J}_{\delta}$
is strictly concave, then $\mbox{\ensuremath{\mathcal{J}}}_{\delta}^{-1}$
is strictly convex.

It is difficult to calculate a closed-form for $\psi_{\delta}$. Therefore
we will argue that all the assumptions on $\psi_{\delta}$ are satisfied.
In particular, we need to show that $x\mapsto\psi_{\delta}(x)/x^{r}$
decreases for some $r\ge1$.

To see this, we use the fact that $\log(w+1)\le\left(\log w+1\right)1\left\{ w\ge1\right\} +c1\left\{ w<1\right\} $
for all $w>0$ for any $c\ge\log2$. This implies that 
\begin{eqnarray*}
\psi_{\delta}(u) & = & \sup_{v>0}uv-\mathcal{J}_{\delta}^{-1}(v)\\
 & = & \sup_{w>0}u\mathcal{J}_{\delta}(w)-w\\
 & = & \sup_{w>0}\left\{ u\left[A_{0,\delta}+A_{1}\log(w+1)+A_{2,\delta}\sqrt{w}\right]-w\right\} \\
 & = & uA_{0,\delta}+\sup_{w>0}\left\{ uA_{1}\left(\left(\log w+1\right)1\left\{ w\ge1\right\} +c1\left\{ w<1\right\} \right)+uA_{2,\delta}\sqrt{w}-w\right\} \\
 & = & uA_{0,\delta}+\max\left\{ \sup_{w\ge1}uA_{1}\left(\log w+1\right)+uA_{2,\delta}\sqrt{w}-w,\sup_{0<w<1}uA_{1}c+uA_{2,\delta}\sqrt{w}-w\right\} \\
 & \le & uA_{0,\delta}+\max\left\{ \sup_{w>0}uA_{1}\left(\log w+1\right)+uA_{2,\delta}\sqrt{w}-w,\sup_{w>0}uA_{1}c+uA_{2,\delta}\sqrt{w}-w\right\} 
\end{eqnarray*}


The first term in the $\max$ is maximized at $\hat{w}$ where 
\begin{eqnarray*}
\frac{uA_{1}}{\hat{w}}+\frac{uA_{2,\delta}}{2}\frac{1}{\sqrt{\hat{w}}}-1=0 & \iff & -\hat{w}+\frac{uA_{2,\delta}}{2}\sqrt{\hat{w}}+uA_{1}=0\\
 & \iff & \sqrt{\hat{w}}=\frac{-\frac{uA_{2,\delta}}{2}-\sqrt{\left(\frac{uA_{2,\delta}}{2}\right)^{2}+4uA_{1}}}{-2}=\frac{uA_{2,\delta}}{4}+\sqrt{\left(\frac{uA_{2,\delta}}{4}\right)^{2}+uA_{1}}
\end{eqnarray*}


As 
\[
\sqrt{\hat{w}}=\frac{uA_{2,\delta}}{4}+\sqrt{\left(\frac{uA_{2,\delta}}{4}\right)^{2}+uA_{1}}\le\frac{uA_{2,\delta}}{2}+\sqrt{uA_{1}}
\]
then 
\begin{eqnarray*}
\sup_{w>0}uA_{1}\left(\log w+1\right)+uA_{2,\delta}\sqrt{w}-w & \le & uA_{1}\left(\log\hat{w}+1\right)+uA_{2,\delta}\left(\frac{uA_{2,\delta}}{2}+\sqrt{uA_{1}}\right)-\left(\frac{uA_{2,\delta}}{2}+\sqrt{uA_{1}}\right)^{2}\\
 & = & uA_{1}\left(\log\hat{w}+1\right)+\left(\frac{uA_{2,\delta}}{2}-\sqrt{uA_{1}}\right)\left(\frac{uA_{2,\delta}}{2}+\sqrt{uA_{1}}\right)\\
 & = & uA_{1}\log\hat{w}+\left(\frac{uA_{2,\delta}}{2}\right)^{2}.
\end{eqnarray*}


The second term in the $\max$ is maximized at $\hat{w}$ where 
\[
\frac{uA_{2,\delta}}{2}\frac{1}{\sqrt{\hat{w}}}-1=0\iff\sqrt{\hat{w}}=\frac{uA_{2,\delta}}{2}
\]


Thus
\[
\sup_{w>0}uA_{1}c+uA_{2,\delta}\sqrt{w}-w=uA_{1}c+\left(\frac{uA_{2,\delta}}{2}\right)^{2}.
\]


As long as $c\ge2\log\left(\frac{uA_{2,\delta}}{2}+\sqrt{uA_{1}}\right)\vee\log2$,
then since

\begin{eqnarray*}
A_{0} & = & \frac{\log n_{V}}{\sqrt{n_{V}}}c_{2}JK\log\left(\frac{\Delta_{\Lambda}\delta K_{2}}{K}\left(\|\epsilon\|_{L_{\psi_{2}}}+K\right)\right)\\
 & A_{1}= & \frac{\log n_{V}}{\sqrt{n_{V}}}c_{2}JK\frac{r}{2}\\
 & A_{2}= & c_{3}\sqrt{J}\left[\sqrt{\log\left(\Delta_{\Lambda}\|\epsilon\|_{L_{2}}\delta n_{v}+1\right)}+1\right]
\end{eqnarray*}


we have for some constant $\tilde{c}$ that depends on $r,K,K_{2},\|\epsilon\|_{L_{\psi_{2}}}$,
\begin{eqnarray*}
\psi_{\delta}(u) & \le & u\left[A_{0,\delta}+A_{1}2\log\left(\frac{uA_{2,\delta}}{2}+\sqrt{uA_{1}}\right)\right]+\left(\frac{u}{2}A_{2,\delta}\right)^{2}\\
 & \le & c_{2}u\frac{\log n_{V}}{\sqrt{n_{V}}}J\tilde{c}\log\left(\tilde{c}J\Delta_{\Lambda}u\delta\log n_{v}+1\right)+c_{3}u^{2}J\left[\log\left(\tilde{c}\Delta_{\Lambda}\delta n_{v}+1\right)+1\right]
\end{eqnarray*}


Thus $\psi_{\delta}(u)/u^{2}$ decreases. So we set $r=2$. (lol this
is the other $r$ in the original theorem) (second line follows from
lots of rearranging and simplifying)

Let $q\rightarrow1$. Then

\begin{eqnarray*}
 &  & \lim_{q\rightarrow1}\epsilon_{q,\delta}(1/q)\\
 & = & \psi_{\delta}\left(\frac{2(1+a)}{a}\frac{1}{\sqrt{n_{V}}}\right)\vee\frac{1}{n_{V}}\\
 & \le & c_{2}\frac{1+a}{a}\frac{J\log n_{V}}{n_{V}}\tilde{c}\log\left(\tilde{c}\frac{1+a}{a}J\Delta_{\Lambda}\delta\right)\\
 &  & +c_{3}\left(\frac{1+a}{a}\right)^{2}\frac{J}{n_{V}}\left[\log\left(\tilde{c}\Delta_{\Lambda}\delta n_{v}+1\right)+1\right]\\
 & \le & c_{4}\left(\frac{1+a}{a}\right)^{2}\frac{J\log n_{V}}{n_{V}}\tilde{c}\log\left(\frac{\left(1+a\right)}{a}\tilde{c}\Delta_{\Lambda}J\delta+1\right)
\end{eqnarray*}


Finally, let's do the summation with $\sigma=\sigma_{0}$. Then 
\begin{eqnarray*}
 &  & \sum_{k=1}^{\infty}\Pr\left(c\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}\ge2^{k}\right)\epsilon_{1,2^{k}}(1)\\
 & = & \sum_{k=1}^{\infty}\Pr\left(c\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}\ge2^{k}\sigma\right)\left[kc_{4}\left(\frac{1+a}{a}\right)^{2}\frac{J\log n_{V}}{n_{V}}K\left(1+r\right)\log\left(\frac{\left(1+a\right)}{a}\tilde{c}\Delta_{\Lambda}J\sigma_{0}+1\right)\right]\\
 & \le & \left[c_{4}\left(\frac{1+a}{a}\right)^{2}\frac{J\log n_{V}}{n_{V}}\tilde{c}\log\left(\frac{\left(1+a\right)}{a}\tilde{c}\Delta_{\Lambda}J\sigma_{0}+1\right)\right]\sum_{k=1}^{\infty}k\Pr\left(c\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}\ge2^{k}\right)\\
 & \le & \left[c_{4}\left(\frac{1+a}{a}\right)^{2}\frac{J\log n_{V}}{n_{V}}\tilde{c}\log\left(\frac{\left(1+a\right)}{a}\tilde{c}\Delta_{\Lambda}J\sigma_{0}+1\right)\right]\tilde{h}(n_{T})
\end{eqnarray*}


Now let's finally plug in all the terms. Then
\begin{eqnarray*}
 &  & \mathbb{P}_{D^{(n)}}\left(\|\bar{g}(\hat{\boldsymbol{\lambda}}|D^{(n)})(x)-g^{*}(x)\|_{L_{2}}^{2}\right)\\
 & \le & (1+a)\inf_{\lambda\in\Lambda}\left[\mathbb{P}_{D^{(n_{T})}}\left(\|\hat{g}(\boldsymbol{\lambda}|D^{(n_{T})})(x)-g^{*}(x)\|_{L_{2}}^{2}\right)\right]\\
 &  & +c_{2}\frac{\left(1+a\right)^{2}}{a}\frac{J\log n_{V}}{n_{V}}\tilde{c}\log\left(\frac{\left(1+a\right)}{a}\tilde{c}\Delta_{\Lambda}J\sigma_{0}+1\right)\left(1+\tilde{h}(n_{T})\right).
\end{eqnarray*}

\end{proof}
Note that in certain cases, the integral bound provided in the theorem
might be easier to reason with. To derive it, note that for any positive
function $h$
\begin{eqnarray*}
 &  & \sum_{k=1}^{\infty}k\Pr\left(h\left(D^{(n_{T})}\right)\ge2^{k}\sigma\right)\\
 & = & \sum_{k=1}^{\infty}k\int1\left\{ h\left(D^{(n_{T})}\right)\ge2^{k}\sigma\right\} d\mu\left(D^{(n_{T})}\right)\\
 & = & \int1\left\{ \log_{2}\left(h\left(D^{(n_{T})}\right)/\sigma\right)\ge1\right\} \sum_{k=1}^{\log_{2}\left(h\left(D^{(n_{T})}\right)/\sigma\right)}kd\mu\left(D^{(n_{T})}\right)\\
 & = & \int1\left\{ \log_{2}\left(h\left(D^{(n_{T})}\right)/\sigma\right)\ge1\right\} \frac{1}{2}\left(\log_{2}\left(h\left(D^{(n_{T})}\right)/\sigma\right)\right)\left(\log_{2}\left(h\left(D^{(n_{T})}\right)/\sigma\right)+1\right)d\mu\left(D^{(n_{T})}\right)\\
 & \le & \int\left(\log_{2}\left(h\left(D^{(n_{T})}\right)/\sigma\right)\right)^{2}d\mu\left(D^{(n_{T})}\right).
\end{eqnarray*}


The bound 
\[
\tilde{h}(n_{T})\ge\sum_{k=1}^{\infty}k\Pr\left(c\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}\ge2^{k}\sigma\right)\approx\int\left(\log_{2}\left(c\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}/\sigma\right)\right)^{2}d\mu\left(D^{(n_{T})}\right)
\]
 can be interpretted as a way of controlling the tail behavior of
the Lipschitz factor $G(x|D^{(n_{T})})$. Since we only need to control
the $\log$ of the $\psi_{2}$-norm, the tail behavior of the Lipschitz
factor can actually be quite crazy. As we will see, the Lipschitz
factor will turn out to be $\|G(x|D^{(n_{T})})\|_{L_{\psi_{2}}}=n_{T}^{\kappa}\left(P_{n_{T}}\epsilon^{2}\right)\|\|x\|_{2}\|_{L_{\psi_{2}}}$
for some constant $\kappa$. So $\tilde{h}(n_{T})$ is growing at
some $\log n_{T}$ rate.
\end{document}
